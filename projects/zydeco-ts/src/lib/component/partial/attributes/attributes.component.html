<div class="container pb-5" *ngIf="editType == 'create' || model !== undefined">
    <zydeco-attributes-header [editType]="editType"></zydeco-attributes-header>
    <ng-container *ngFor="let attribute of getFlatAttributes()">
        <ng-container [ngSwitch]="attribute.type.toLowerCase()">
            <zydeco-string-attribute *ngSwitchDefault
                [attributeDefinition]="attribute"
                [editType]="editType" 
                [currentValue]="model !== undefined ? getCurrentModelValue(attribute.modelSelector) : ''" 
                [ngModel]="getCurrentDeltaValue(attribute.deltaSelector)"
                (ngModelChange)="setCurrentDeltaValue(attribute.deltaSelector, $event)">
            </zydeco-string-attribute>
    
            <zydeco-date-attribute *ngSwitchCase="'date'"
                [attributeDefinition]="attribute"
                [editType]="editType"
                [currentValue]="model !== undefined ? getCurrentModelValue(attribute.modelSelector) : ''"
                [ngModel]="getCurrentDeltaValue(attribute.deltaSelector)"
                (ngModelChange)="setCurrentDeltaValue(attribute.deltaSelector, $event)">
            </zydeco-date-attribute>
    
            <zydeco-select-attribute *ngSwitchCase="'select'"
                [attributeDefinition]="attribute"
                [editType]="editType"
                [currentValue]="model !== undefined ? getCurrentModelValue(attribute.modelSelector) : ''"
                [ngModel]="getCurrentDeltaValue(attribute.deltaSelector)"
                (ngModelChange)="setCurrentDeltaValue(attribute.deltaSelector, $event)">
            </zydeco-select-attribute>
    
            <zydeco-boolean-attribute *ngSwitchCase="'boolean'"
                [attributeDefinition]="attribute"
                [editType]="editType"
                [currentValue]="model !== undefined ? getCurrentModelValue(attribute.modelSelector) : ''"
                [ngModel]="getCurrentDeltaValue(attribute.deltaSelector)"
                (ngModelChange)="setCurrentDeltaValue(attribute.deltaSelector, $event)">
            </zydeco-boolean-attribute>
    
            <zydeco-number-attribute *ngSwitchCase="'number'"
                [attributeDefinition]="attribute"
                [editType]="editType"
                [currentValue]="model !== undefined ? getCurrentModelValue(attribute.modelSelector) : ''"
                [ngModel]="getCurrentDeltaValue(attribute.deltaSelector)"
                (ngModelChange)="setCurrentDeltaValue(attribute.deltaSelector, $event)">
            </zydeco-number-attribute>
        </ng-container>

        <div class="container-fluid border border-info"
            *ngIf="attribute.instructions != ''">
            <div class="row py-2">
                <div class="col" 
                    (click)="toggleInstructions()">
                        <p class="m-0">Instructions for field <strong>{{ attribute.title }}</strong> {{ showInstructions ? '-' : '+' }}</p>
                </div>
            </div>
            <div class="row">
                <div class="col"
                    *ngIf="showInstructions"
                    (click)="toggleInstructions()">
                        <p>{{ attribute.instructions }}</p>
                </div>
            </div>
        </div>
    </ng-container>  

    <ng-container *ngFor="let attribute of getNestedAttributes()">
        <zydeco-nested-attribute
            [attributeDefinition]="attribute"
            [editType]="editType"
            [models]="getCurrentModelValue(attribute.modelSelector)"
            [deltas]="getCurrentDeltaValue(attribute.deltaSelector)">
        </zydeco-nested-attribute>
    </ng-container>
</div>